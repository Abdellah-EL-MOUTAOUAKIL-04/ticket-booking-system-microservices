<div class="p-4">
  <p-data-view
    #dv
    [value]="venues"
    [layout]="layout"
    [rows]="6"
    [paginator]="true"
    [rowsPerPageOptions]="[6, 12, 24]"
  >
    <ng-template #header>
      <div class="surface-ground p-4 border-round mb-3">
        <div class="flex flex-column lg:flex-row lg:justify-content-between lg:align-items-center">
          <div class="flex flex-column gap-2">
            <h1 class="text-3xl font-bold text-900 m-0">Venue Management</h1>
            <p class="text-600 m-0">Manage your venues, capacities, and availability</p>
          </div>
          <div class="flex align-items-center gap-3 mt-3 lg:mt-0">
            <div class="p-input-icon-left flex-auto lg:flex-none">
              <input pInputText placeholder="Search venues..." class="w-full lg:w-25rem" />
            </div>
            <p-selectButton
              [(ngModel)]="layout"
              [options]="layoutOptions"
              [allowEmpty]="false"
              styleClass="mb-0"
            >
              <ng-template #item let-option>
                <i [class]="option === 'list' ? 'pi pi-bars' : 'pi pi-table'" class="text-xl"></i>
              </ng-template>
            </p-selectButton>
            <p-button
              icon="pi pi-plus"
              label="Add Venue"
              severity="success"
              (click)="openNewVenue()"
              styleClass="p-button-raised"
            ></p-button>
          </div>
        </div>
      </div>
      <p-dialog
        header="{{ isEditMode ? 'Edit Venue' : 'New Venue' }}"
        [(visible)]="showDialog"
        [style]="{ width: '500px' }"
        [modal]="true"
        [closable]="true"
        styleClass="p-fluid"
        [draggable]="false"
      >
        <form [formGroup]="newVenueForm" (ngSubmit)="handleForm()">
          <div class="field">
            <label for="name">Venue Name</label>
            <input pInputText id="name" formControlName="name" placeholder="Enter venue name" />
          </div>
          <div class="field">
            <label for="totalCapacity">Total Capacity</label>
            <p-inputnumber
              id="totalCapacity"
              formControlName="totalCapacity"
              [showButtons]="true"
              buttonLayout="horizontal"
              spinnerMode="horizontal"
              [min]="0"
              [step]="10"
              decrementButtonClass="p-button-danger"
              incrementButtonClass="p-button-success"
              incrementButtonIcon="pi pi-plus"
              decrementButtonIcon="pi pi-minus"
              placeholder="Enter capacity"
            />
          </div>
          <div class="field">
            <label for="address">Address</label>
            <input
              pInputText
              id="address"
              formControlName="address"
              placeholder="Enter venue address"
            />
          </div>
          <div class="field">
            <label for="active">Status</label>
            <p-selectbutton
              id="active"
              formControlName="active"
              [options]="[
                { label: 'Active', value: true },
                { label: 'Inactive', value: false }
              ]"
              optionLabel="label"
              optionValue="value"
            >
              <ng-template let-item>
                <i
                  [class]="
                    item.value
                      ? 'pi pi-check-circle text-green-500'
                      : 'pi pi-times-circle text-red-500'
                  "
                  class="mr-2"
                ></i>
                {{ item.label }}
              </ng-template>
            </p-selectbutton>
          </div>
          <div class="flex justify-content-end gap-2 mt-4 pt-4 border-top-1 border-gray-200">
            <p-button
              label="Cancel"
              (click)="handleCloseFormDialog()"
              styleClass="p-button-outlined"
              icon="pi pi-times"
            ></p-button>
            <p-button
              [label]="isEditMode ? 'Update Venue' : 'Create Venue'"
              type="submit"
              [disabled]="newVenueForm.invalid"
              styleClass="p-button-primary"
              icon="pi pi-check"
            ></p-button>
          </div>
        </form>
      </p-dialog>
      <p-confirmdialog />
    </ng-template>

    <!-- LIST LAYOUT -->
    <ng-template #list let-items>
      <div>list layout</div>
    </ng-template>

    <!-- GRID LAYOUT -->
    <ng-template #grid let-items>
      @if (isLoading) {
      <div class="grid grid-nogutter md:grid-cols-2 lg:grid-cols-3 gap-4">
        <div *ngFor="let i of [1, 2, 3, 4, 5, 6]" class="col-12 md:col-6 lg:col-4">
          <p-card styleClass="h-full shadow-2">
            <ng-template pTemplate="content">
              <div class="flex flex-col gap-4">
                <p-skeleton shape="rectangle" size="100%" styleClass="h-48"></p-skeleton>
                <p-skeleton width="70%" height="2rem" styleClass="mb-2"></p-skeleton>
                <p-skeleton width="90%" height="1rem" styleClass="mb-2"></p-skeleton>
                <p-skeleton width="50%" height="2rem"></p-skeleton>
                <div class="flex justify-content-between">
                  <p-skeleton shape="circle" size="3rem" styleClass="mr-2"></p-skeleton>
                  <p-skeleton shape="circle" size="3rem" styleClass="mr-2"></p-skeleton>
                  <p-skeleton shape="circle" size="3rem"></p-skeleton>
                </div>
              </div>
            </ng-template>
          </p-card>
        </div>
      </div>
      } @else {
      <div class="flex flex-wrap gap-4 px-2">
        <div *ngFor="let item of items" class="flex-1 min-w-[350px]">
          <div
            class="surface-card border-round-xl shadow-2 h-full transform transition-all duration-200 hover:shadow-8"
          >
            <div class="relative overflow-hidden">
              <img
                class="w-full h-[200px] border-round-t-xl object-cover transform transition-transform hover:scale-105 duration-300"
                [src]="
                  'https://images.ctfassets.net/v7wr16nrr0mz/4aa4cvN73SlIqRPdbl0BDX/1e3c63b3f241093948fc4c888af21d38/populous_venue_productization_header-bowl.jpg'
                "
                [alt]="item.name"
              />
              <div class="absolute top-0 right-0 m-3">
                <p-tag
                  [value]="item.active ? 'Active' : 'Inactive'"
                  [severity]="item.active ? 'success' : 'danger'"
                  [rounded]="true"
                  styleClass="shadow-3"
                ></p-tag>
              </div>
            </div>
            <div class="p-4 flex flex-column gap-3">
              <div class="flex flex-column gap-2">
                <h3 class="text-xl font-bold m-0 text-900">{{ item.name }}</h3>
                <div class="flex align-items-center text-600">
                  <i class="pi pi-map-marker mr-2"></i>
                  <span class="line-clamp-1">{{ item.address }}</span>
                </div>
              </div>
              <div
                class="surface-ground px-4 py-3 border-round-2xl inline-flex align-items-center w-fit"
              >
                <i class="pi pi-users text-xl mr-2 text-primary"></i>
                <span class="font-semibold text-primary text-xl">{{ item.totalCapacity }}</span>
                <span class="text-500 ml-2">seats</span>
              </div>
              <div class="flex justify-content-between mt-3 pt-3 border-top-1 surface-border">
                <div class="flex gap-2">
                  <p-button
                    icon="pi pi-pencil"
                    severity="warn"
                    (click)="editVenue(item)"
                    pTooltip="Edit Venue"
                    tooltipPosition="top"
                    class="p-button-rounded p-button-sm"
                  />
                  <p-button
                    icon="pi pi-trash"
                    severity="danger"
                    (click)="confirmDelete(item)"
                    pTooltip="Delete Venue"
                    tooltipPosition="top"
                    class="p-button-rounded p-button-sm"
                  />
                </div>
                <p-togglebutton
                  [(ngModel)]="item.active"
                  onLabel="Active"
                  offLabel="Inactive"
                  onIcon="pi pi-check"
                  offIcon="pi pi-times"
                  class="w-36"
                  ariaLabel="Do you confirm"
                />
              </div>
            </div>
          </div>
        </div>
      </div>
      }
    </ng-template>
  </p-data-view>
</div>
